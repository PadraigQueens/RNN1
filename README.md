# RNN1

RNN Code

Importing Libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings("ignore")
Reading Dataset
training_set=pd.read_csv("Belfast-2015-2022-data-nd.csv")
training_set.head()
Number	O3	NO2	PM10	PM2.5	temp	humidity
0	1	48	28	9	6	3.2	85.4
1	2	61	17	15	7	5.0	76.1
2	3	53	23	9	6	2.0	85.3
3	4	51	24	7	6	1.5	90.3
4	5	59	14	11	7	2.8	76.9
training_set
Number	O3	NO2	PM10	PM2.5	temp	humidity
0	1	48	28	9	6	3.2	85.4
1	2	61	17	15	7	5.0	76.1
2	3	53	23	9	6	2.0	85.3
3	4	51	24	7	6	1.5	90.3
4	5	59	14	11	7	2.8	76.9
...	...	...	...	...	...	...	...
2246	2247	58	14	9	5	7.3	86.1
2247	2248	64	10	7	5	2.7	85.5
2248	2249	40	30	12	8	5.7	90.3
2249	2250	57	23	6	4	7.4	86.4
2250	2251	26	41	12	9	4.5	96.1
2251 rows Ã— 7 columns

training_set = training_set.iloc[:,2:3].values
training_set
array([[28],
       [17],
       [23],
       ...,
       [30],
       [23],
       [41]], dtype=int64)
from sklearn.preprocessing import MinMaxScaler
sc = MinMaxScaler()
training_set = sc.fit_transform(training_set)
training_set
array([[0.21551724],
       [0.12068966],
       [0.17241379],
       ...,
       [0.23275862],
       [0.17241379],
       [0.32758621]])
len(training_set)
2251
x_train = training_set[0:2250]
y_train = training_set[1:2251]
x_train = np.reshape(x_train,(2250,1,1))
x_train
array([[[0.21551724]],

       [[0.12068966]],

       [[0.17241379]],

       ...,

       [[0.06034483]],

       [[0.23275862]],

       [[0.17241379]]])
Building the RNN
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
reg = Sequential()
reg.add(LSTM(units=4,activation='sigmoid',input_shape=(None,1)))
reg.add(Dense(units=1))
reg.compile(optimizer='adam',loss='mean_squared_error')
reg.fit(x_train,y_train,batch_size=10,epochs=100)
Epoch 1/100
225/225 [==============================] - 3s 3ms/step - loss: 0.0175
Epoch 2/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0122
Epoch 3/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0116
Epoch 4/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0110
Epoch 5/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0105
Epoch 6/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0100
Epoch 7/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0097
Epoch 8/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0093
Epoch 9/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0090
Epoch 10/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0087
Epoch 11/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0085
Epoch 12/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0084
Epoch 13/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0082
Epoch 14/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0081
Epoch 15/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0080
Epoch 16/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0080
Epoch 17/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 18/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 19/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 20/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 21/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 22/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 23/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 24/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 25/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 26/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 27/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 28/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 29/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 30/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 31/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 32/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 33/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 34/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 35/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 36/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 37/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 38/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 39/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 40/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 41/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 42/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 43/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 44/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 45/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 46/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 47/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 48/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 49/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 50/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 51/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 52/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 53/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 54/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0079
Epoch 55/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 56/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0079
Epoch 57/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 58/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 59/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 60/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 61/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 62/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 63/100
225/225 [==============================] - 2s 7ms/step - loss: 0.0078
Epoch 64/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0079
Epoch 65/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 66/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 67/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 68/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 69/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 70/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 71/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 72/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 73/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 74/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 75/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 76/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 77/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 78/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 79/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 80/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 81/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0079
Epoch 82/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 83/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 84/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 85/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
Epoch 86/100
225/225 [==============================] - 1s 6ms/step - loss: 0.0078
Epoch 87/100
225/225 [==============================] - 2s 7ms/step - loss: 0.0078
Epoch 88/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 89/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 90/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0079
Epoch 91/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 92/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 93/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 94/100
225/225 [==============================] - 1s 6ms/step - loss: 0.0079
Epoch 95/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 96/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0079
Epoch 97/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 98/100
225/225 [==============================] - 1s 4ms/step - loss: 0.0078
Epoch 99/100
225/225 [==============================] - 1s 5ms/step - loss: 0.0078
Epoch 100/100
225/225 [==============================] - 1s 3ms/step - loss: 0.0078
<keras.callbacks.History at 0x2cc63e87520>
Part 3: Making the Prediction and Visulising the result
test_set=pd.read_csv("Jan-23.csv")
test_set.head()
â€‹
O3	NO2	PM10	PM2.5	temp	humidity
0	44	19	8	7	5.2	89.6
1	19	38	18	15	1.2	92.6
2	55	21	6	4	9.3	89.5
3	63	22	8	5	10.7	83.0
4	49	23	19	8	9.5	85.0
test_set.tail()
O3	NO2	PM10	PM2.5	temp	humidity
26	25	24	18	10	4.2	84.4
27	40	22	12	8	6.4	88.4
28	59	10	9	5	7.1	83.8
29	55	19	16	8	7.0	77.9
30	75	7	15	8	7.7	75.2
real_NO2 = test_set.iloc[:,1:2].values
real_NO2
array([[19],
       [38],
       [21],
       [22],
       [23],
       [22],
       [16],
       [14],
       [15],
       [18],
       [22],
       [18],
       [13],
       [ 9],
       [17],
       [26],
       [21],
       [18],
       [28],
       [48],
       [28],
       [20],
       [32],
       [25],
       [14],
       [26],
       [24],
       [22],
       [10],
       [19],
       [ 7]], dtype=int64)
inputs = real_NO2
inputs = sc.transform(inputs)
inputs
array([[0.13793103],
       [0.30172414],
       [0.15517241],
       [0.1637931 ],
       [0.17241379],
       [0.1637931 ],
       [0.11206897],
       [0.09482759],
       [0.10344828],
       [0.12931034],
       [0.1637931 ],
       [0.12931034],
       [0.0862069 ],
       [0.05172414],
       [0.12068966],
       [0.19827586],
       [0.15517241],
       [0.12931034],
       [0.21551724],
       [0.38793103],
       [0.21551724],
       [0.14655172],
       [0.25      ],
       [0.18965517],
       [0.09482759],
       [0.19827586],
       [0.18103448],
       [0.1637931 ],
       [0.06034483],
       [0.13793103],
       [0.03448276]])
len(inputs)
31
inputs = np.reshape(inputs,(31,1,1))
inputs
array([[[0.13793103]],

       [[0.30172414]],

       [[0.15517241]],

       [[0.1637931 ]],

       [[0.17241379]],

       [[0.1637931 ]],

       [[0.11206897]],

       [[0.09482759]],

       [[0.10344828]],

       [[0.12931034]],

       [[0.1637931 ]],

       [[0.12931034]],

       [[0.0862069 ]],

       [[0.05172414]],

       [[0.12068966]],

       [[0.19827586]],

       [[0.15517241]],

       [[0.12931034]],

       [[0.21551724]],

       [[0.38793103]],

       [[0.21551724]],

       [[0.14655172]],

       [[0.25      ]],

       [[0.18965517]],

       [[0.09482759]],

       [[0.19827586]],

       [[0.18103448]],

       [[0.1637931 ]],

       [[0.06034483]],

       [[0.13793103]],

       [[0.03448276]]])
pred_NO2 = reg.predict(inputs)
pred_NO2
1/1 [==============================] - 0s 470ms/step
array([[0.14958064],
       [0.24719797],
       [0.15981297],
       [0.16493551],
       [0.17006205],
       [0.16493551],
       [0.1342691 ],
       [0.12408982],
       [0.12917642],
       [0.14447151],
       [0.16493551],
       [0.14447151],
       [0.1190096 ],
       [0.09875928],
       [0.1393675 ],
       [0.18546133],
       [0.15981297],
       [0.14447151],
       [0.19574071],
       [0.29851377],
       [0.19574071],
       [0.15469451],
       [0.21631952],
       [0.1803252 ],
       [0.12408982],
       [0.18546133],
       [0.17519204],
       [0.16493551],
       [0.10381062],
       [0.14958064],
       [0.08868058]], dtype=float32)
y_pred = sc.inverse_transform(pred_NO2)
y_pred
array([[20.351355],
       [31.674967],
       [21.538305],
       [22.132519],
       [22.727198],
       [22.132519],
       [18.575216],
       [17.394419],
       [17.984465],
       [19.758696],
       [22.132519],
       [19.758696],
       [16.805113],
       [14.456077],
       [19.16663 ],
       [24.513514],
       [21.538305],
       [19.758696],
       [25.705923],
       [37.627598],
       [25.705923],
       [20.944563],
       [28.093063],
       [23.917723],
       [17.394419],
       [24.513514],
       [23.322277],
       [22.132519],
       [15.042032],
       [20.351355],
       [13.286947]], dtype=float32)
plt.figure(figsize=(13,6))
plt.plot(real_NO2,color='green',label='Real levels of NO2')
plt.plot(y_pred,color='black',label= 'Predicted NO2')
plt.title("Using RNN to predict NO2 levels in comparison with actual levels at Belfast City Centre (Jan 23)", fontsize=20)
plt.xlabel('Month of January',fontsize=14)
plt.ylabel('NO2 (V Âµg/mÂ³)', fontsize=14)
plt.legend()
plt.show()
